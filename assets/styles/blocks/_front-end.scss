/**
* Blocks Front-end
*
*	- Common
*	- Alignment
*	- Preformatted
*	- Paragraph
*	- Color Palette
*	- Buttons
*	- Lists
*	- Tables
*	- Separators
*	- Quotes
*	- Images
*	- Cover Image
*/

/* --------- Still under development --------- */

/* Common */
.wp-block,
.wp-block-column,
.wp-block-cover,
.wp-block-media-text {
	margin-bottom: space(s);
}

/* Alignment */

.full-width-content {

	.alignwide {

		margin-left: calc(-100vw / 2 + 100% / 2);
		margin-right: calc(-100vw / 2 + 100% / 2);
		max-width: 100vw;

		// Cover Image
		&.wp-block-cover {
			width: 100vw;
		}
	}
}

.content-sidebar,
.sidebar-content {

	.alignwide {
		margin: space(stack, s);
		width: 100%;
	}
}

/* Preformatted */
pre.wp-block-preformatted {
	font-family: $base-font-mono;
	overflow: scroll;

	@extend %font-size-s;
}

/* Paragraph */

p {

	&.has-background,
	&.has-box-shadow {
		padding: space(xs);
	}

	&.has-drop-cap:not(:focus)::first-letter {
		line-height: line-height(drop-cap);
		font-size: 7rem;
		margin: 0 0.5rem 0 0;
	}

	&.has-drop-cap:not(:focus)::after {
		padding-top: 0;
	}

	&.has-small-font-size {

		@extend %font-size-s;

		&.has-drop-cap:not(:focus)::first-letter {
			line-height: line-height(drop-cap-s);
			font-size: 4rem;
		}

		&.s-break {

			@include mq($from: tablet) {
				line-height: line-height(xs); // Break the vertical rhythm.
			}
		}
	}

	&.has-medium-font-size {

		@extend %font-size-l;

		&.has-drop-cap:not(:focus)::first-letter {
			line-height: line-height(drop-cap-l);
			font-size: 7rem;
		}

		&.m-break {
			line-height: line-height(l-break); // Break the vertical rhythm.
		}
	}

	&.has-large-font-size {

		@extend %font-size-xl;

		&.has-drop-cap:not(:focus)::first-letter {
			line-height: line-height(drop-cap-xl);
			font-size: 7rem;
		}
	}

	&.has-huge-font-size {

		@extend %font-size-xxl;

		&.has-drop-cap:not(:focus)::first-letter {
			line-height: line-height(drop-cap-xxl);
			font-size: 14rem;
			margin-right: 0.75rem;
		}
	}
}

/* Color Palette */
// Keep in synch with values defined in lib/blocks/blocks-setup.php

$color-palette: (
	accent: color(accent, base),
	white: color(light, soft),
	light: color(light, base),
	grey: color(light, strong),
	dark: color(dark, soft),
	black: color(dark, base),
	info: color(info, base),
	danger: color(danger, base),
	success: color(success, base),
	warning: color(warning, base),
	star: color(star, base),
);

@each $name, $color in $color-palette {

	.has-#{$name}-color {
		color: $color;
	}

	.has-#{$name}-background-color {
		background-color: $color;
	}
}

.has-text-color,
.has-background {

	a {

		&:focus,
		&:hover {
			color: inherit;
		}
	}
}

/* Buttons */

.wp-block-button {
	margin-bottom: space(s);

	.wp-block-button__link {
		border: none;
		border-radius: $base-border-radius;
		cursor: pointer;
		font-weight: 700;
		font-family: $base-font-sans;
		height: space(m); // Preserve height despite borders.
		padding: space(inset-squish, xs);
		text-align: center;
		text-decoration: none;
		transition: all $base-transition;
		white-space: normal;
		min-width: space(xl);

		@extend %font-size-s;

		&:focus,
		&:hover {
			opacity: 1;

			@extend %box-shadow-buttons;
		}
	}

	.has-text-color {

		@each $name, $color in $color-palette {

			&.has-#{$name}-color {

				&:focus,
				&:hover {
					color: $color;
				}
			}
		}
	}

	&.is-style-outline,
	&.is-style-small-outline {

		.wp-block-button__link {
			border: 1px solid;
			background-color: color(light, soft);
			color: color(dark, base);

			&.has-text-color,
			&.has-background {

				@each $name, $color in $color-palette {

					&.has-#{$name}-color {
						color: $color;
					}

					&.has-#{$name}-background-color {
						background-color: $color;
					}
				}
			}
		}
	}

	&.is-style-small,
	&.is-style-small-outline {

		.wp-block-button__link {
			height: 3rem; // Break vertical rhythm.
			min-width: space(l);
			padding: space(inset-squish, xxs);

			@extend %font-size-xs;
		}
	}
}

/* Lists */

.content {

	.entry-content {

		ul {

			&.wp-block-latest-posts,
			&.wp-block-latest-posts,
			&.wp-block-categories,
			&.wp-block-archives {
				list-style: none;
				margin-left: 0;

				li {
					list-style: none;

					a {
						font-family: $base-font-sans;
					}
				}
			}

			&.wp-block-latest-posts {

				&.is-grid {

					li {
						margin-bottom: 0;
					}
				}
			}
		}
	}
}

/* Tables */

.wp-block-table {

	&.is-style-stripes {
		border-bottom: none;
		border-top-color: transparent;
	}
}

/* Separators */

.wp-block-separator {
	width: 20%;

	&.is-style-empty,
	&.is-style-dots,
	&.is-style-wide {
		min-width: 100%;
		width: 100%;
	}

	&.is-style-dots {
		line-height: line-height(m);
		margin: space(divider, s);

		&::before {
			float: left;
			font-size: 2rem;
			line-height: line-height(m);
			margin: 0 auto;
			width: 100%;
		}
	}

	&.is-style-empty {
		border: none;
		height: space(s);
		margin: 0;
		padding: 0;
	}
}

/* Quotes */

.wp-block-pullquote,
.wp-block-quote {

	p {
		font-weight: 700;

		@extend %font-size-l;
	}

	cite {
		display: block;
	}
}

.wp-block-quote {

	&.is-style-large,
	&.is-large {
		margin: space(divider, s);
		padding: 0;

		p {

			@extend %font-size-xl;
		}

		cite,
		footer {

			@extend %font-size-s;
		}
	}
}

.wp-block-pullquote {
	border-bottom: 2px solid color(dark, base);
	border-top: 2px solid color(dark, base);
	padding: space(column, m);
	margin: space(stack, s);

	blockquote {
		margin-bottom: calc(2rem - 2px); // Compensate bottom border width.
		margin-top: calc(2rem - 2px); // Compensate top border width.

		&::before {
			display: none;
		}
	}

	&.alignleft,
	&.alignright {
		border: none;
		margin: space(stack, xs);
		max-width: 100%;
		padding: 0;

		@include mq($from: phone) {
			max-width: 200px;
		}

		@include mq($from: tablet) {
			max-width: 350px;
		}

		blockquote {
			margin: 0;
		}

		p {

			@extend %font-size-l;
		}
	}

	&.alignleft {
		margin-right: 2rem;

		@include mq($from: tablet) {
			margin-left: -150px;
		}
	}

	&.alignright {
		margin-left: 2rem;

		@include mq($from: tablet) {
			margin-right: -150px;
		}
	}

	&.is-style-solid-color {
		border: none;
		margin-bottom: space(m);
		margin-top: space(m);
		padding-bottom: space(m);
		padding-top: space(m);

		blockquote {
			margin: 0 auto;

			p {
				margin: space(stack, xs);

				@extend %font-size-l;
			}

			cite {
				text-transform: uppercase;
			}
		}
	}
}

/* Images */

.wp-block-image {

	figcaption {
		color: color(dark, soft);
		margin: space(divider, xxs); // Break verticat rhythm.
		text-align: center;

		@extend %font-size-s;
	}
}

/* Cover Image */

.wp-block-cover__inner-container,
.editor-inner-blocks {

	.wp-block-cover-image &,
	.wp-block-cover & {
		width: calc(100% - 6rem);
		color: color(light, base);

		// stylelint-disable
		// Fix no-descending-specificity for p selector
		p,
		h1,
		h2,
		h3,
		h4,
		h5,
		h6 {

			&.has-text-color {

				@each $name, $color in $color-palette {

					&.has-#{$name}-color {
						color: $color;
					}
				}
			}
		}
		// stylelint-enable
	}
}
